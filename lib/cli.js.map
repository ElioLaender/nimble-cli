{"version":3,"file":"cli.js","sourceRoot":"","sources":["../src/cli.ts"],"names":[],"mappings":"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","sourcesContent":["import 'reflect-metadata';\r\nimport fs from 'fs-extra';\r\nimport path from 'path';\r\nimport { Container } from 'inversify';\r\nimport { DependencyRegister } from './dependency-register';\r\nimport { NB } from './nb';\r\n\r\nexport class CLI {\r\n    public static container = new Container();\r\n    public static nb: NB;\r\n    public static package: any;\r\n    public static nimbleVersion: string = '1.0.1';\r\n\r\n    public static get version() { return this.package ? this.package.version : '1.0.0'; }\r\n\r\n    public static get worksPath() { return process.cwd(); }\r\n    \r\n    public static start() {\r\n        this.getInformation();\r\n        DependencyRegister.register(this.container);\r\n\r\n        this.nb = this.container.get<NB>('NB');\r\n        this.nb.setArgurments(process.argv.slice(2));\r\n        this.nb.start();\r\n    }\r\n\r\n    public static inject<T>(type: string) {\r\n        return this.container.get<T>(type);\r\n    }\r\n\r\n    public static worksPathIsRootProject(path?: string) {\r\n        if (!path)\r\n            path = this.worksPath;\r\n        if(!path.endsWith('/'))\r\n            path += '/';\r\n\r\n        if (fs.pathExistsSync(`${path}src`) && fs.existsSync(`${path}package.json`)) {\r\n            let packageFile = null;\r\n            try { packageFile = require(`${path}package.json`); } catch {}\r\n            if (packageFile)\r\n                return packageFile['dependencies'] && packageFile['dependencies']['@nimble-ts/core'];\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public static worksPathIsSourceDir() {\r\n        let dirName = this.worksPath.split(path.sep).pop();\r\n        return dirName === 'src';\r\n    }\r\n\r\n    public static isNimbleProject() {\r\n        let parent = this.worksPath;\r\n        while(parent && parent !== path.sep) {\r\n            if (this.worksPathIsRootProject(parent))\r\n                return true;\r\n            parent = this.getParentPath(parent);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public static getNimbleProjectRootPath() {\r\n        let parent = this.worksPath;\r\n        while(parent && parent !== path.sep) {\r\n            if (this.worksPathIsRootProject(parent))\r\n                return parent;\r\n            parent = this.getParentPath(parent);\r\n        }\r\n        return '';\r\n    }\r\n\r\n    public static getParentPath(completePath: string) {\r\n        let parentPath = path.normalize(completePath + '/..');\r\n        return parentPath;\r\n    }\r\n\r\n    private static getInformation() {\r\n        try {\r\n            this.package = require('package.json');\r\n        }\r\n        catch {\r\n            this.package = require('../package.json');\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nCLI.start();"]}