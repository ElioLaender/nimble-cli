{"version":3,"file":"page-generate.js","sourceRoot":"","sources":["../../../../src/options/generate/page/page-generate.ts"],"names":[],"mappings":"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","sourcesContent":["import { inject, injectable } from 'inversify';\r\nimport inquirer = require('inquirer');\r\nimport { QuestionAnswer } from '../../../core/question-answer.model';\r\nimport { Logger } from '../../../utils/logger.util';\r\nimport { FileCreator } from '../../../core/file-creator/file-creator';\r\nimport { PAGE_HTML, PAGE_SCSS, PAGE_TS } from './page-generate-template';\r\nimport { BaseGenerate } from '../base-generate';\r\n\r\n@injectable()\r\nexport class PageGenerate extends BaseGenerate {\r\n\r\n    constructor(\r\n        @inject('Logger') private logger: Logger\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    public async execute() {\r\n        let answer: QuestionAnswer = await this.question();\r\n        let name = answer.value.trim().toLowerCase();\r\n\r\n        if (this.isValid(name)) {\r\n            this.name = name;\r\n\r\n            if (this.name.startsWith('/'))\r\n                this.name = this.name.substr(1);\r\n            if (this.name.endsWith('/'))\r\n                this.name = this.name.substr(0, this.name.length - 1);\r\n\r\n            await this.startCreatePage();\r\n        }\r\n        else\r\n            await this.execute();\r\n    }\r\n\r\n    public question(): Promise<QuestionAnswer> {\r\n        return inquirer.prompt([{ \r\n            name: 'value',\r\n            type: 'input',\r\n            message: 'What is path and name? (ex.: pages/home)',\r\n        }]);\r\n    };\r\n\r\n    public isValid(name: string): boolean {\r\n        if(name === '') {\r\n            this.logger.showError('Cannot be empty.');\r\n            return false;\r\n        }\r\n        if(name.includes(' ')) {\r\n            this.logger.showError('Cannot contains whitespace.');\r\n            return false;\r\n        }\r\n        if(/[!$%^&*()+|~=`{}\\[\\]:\";'<>?,.]/.test(name)) {\r\n            this.logger.showError('Cannot have the following symbols: !$%^&*()+|~=`{}\\[\\]:\";\\'<>?,.');\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private async startCreatePage() {\r\n        let creator = new FileCreator();\r\n        let { fileInstructions, lastDirectory } = this.getBaseFileInstructions();\r\n        \r\n        let fileDirInstruction = {\r\n            name: this.fileName,\r\n            children: [\r\n                { name: `${this.fileName}.page.html`, content: this.replaceVariablesInContentFile(PAGE_HTML) },\r\n                { name: `${this.fileName}.page.scss`, content: this.replaceVariablesInContentFile(PAGE_SCSS) },\r\n                { name: `${this.fileName}.page.ts`, content: this.replaceVariablesInContentFile(PAGE_TS) },\r\n            ]\r\n        };\r\n\r\n        if (lastDirectory)\r\n            lastDirectory.children.push(fileDirInstruction);\r\n        else\r\n            fileInstructions.push(fileDirInstruction);\r\n\r\n        creator.initialize(fileInstructions);\r\n\r\n        await creator.startCreateFiles((response) => {\r\n            if (!response.error) {\r\n                this.logger.showCreated(response.fileInstruction.completePath());\r\n            }\r\n            else {\r\n                this.logger.showError(response.error);\r\n            }\r\n        });\r\n    }\r\n\r\n    private replaceVariablesInContentFile(content: string) {\r\n        let regex = /\\[\\[(.|\\n)*?\\]\\]/g;\r\n        if (regex.test(content)) {\r\n            content = content.replace(regex, (name) => {\r\n                name = name.replace(/(^\\[\\[)|(\\]\\]$)/g, '');\r\n                if (name !== '')\r\n                    return this.getValueByName(name);\r\n\r\n                return '';\r\n            });\r\n        }\r\n\r\n        return content;\r\n    }\r\n\r\n    private getValueByName(name: string){\r\n        switch(name) {\r\n            case 'Name':\r\n                return this.fileName;\r\n            case 'FriendlyName':\r\n                return this.fileFriendlyName;\r\n        }\r\n        return '';\r\n    }\r\n}"]}